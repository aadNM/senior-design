(this["webpackJsonprasa-frontend"]=this["webpackJsonprasa-frontend"]||[]).push([[6],{2451:function(e,t,n){var r=n(583),a=n(2452),c=n(1203),o=n(2453),i=c((function(e){var t=r(e,o);return t.length&&t[0]===e[0]?a(t):[]}));e.exports=i},2452:function(e,t,n){var r=n(748),a=n(750),c=n(1204),o=n(583),i=n(584),l=n(749),s=Math.min;e.exports=function(e,t,n){for(var u=n?c:a,d=e[0].length,f=e.length,b=f,j=Array(f),h=1/0,v=[];b--;){var O=e[b];b&&t&&(O=o(O,i(t))),h=s(O.length,h),j[b]=!n&&(t||d>=120&&O.length>=120)?new r(b&&O):void 0}O=e[0];var p=-1,x=j[0];e:for(;++p<d&&v.length<h;){var m=O[p],g=t?t(m):m;if(m=n||0!==m?m:0,!(x?l(x,g):u(v,g,n))){for(b=f;--b;){var C=j[b];if(!(C?l(C,g):u(e[b],g,n)))continue e}x&&x.push(g),v.push(m)}}return v}},2453:function(e,t,n){var r=n(1205);e.exports=function(e){return r(e)?e:[]}},2454:function(e,t,n){"use strict";var r=n(2455),a={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var n,c,o,i,l,s,u=!1;t||(t={}),n=t.debug||!1;try{if(o=r(),i=document.createRange(),l=document.getSelection(),(s=document.createElement("span")).textContent=e,s.style.all="unset",s.style.position="fixed",s.style.top=0,s.style.clip="rect(0, 0, 0, 0)",s.style.whiteSpace="pre",s.style.webkitUserSelect="text",s.style.MozUserSelect="text",s.style.msUserSelect="text",s.style.userSelect="text",s.addEventListener("copy",(function(r){if(r.stopPropagation(),t.format)if(r.preventDefault(),"undefined"===typeof r.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var c=a[t.format]||a.default;window.clipboardData.setData(c,e)}else r.clipboardData.clearData(),r.clipboardData.setData(t.format,e);t.onCopy&&(r.preventDefault(),t.onCopy(r.clipboardData))})),document.body.appendChild(s),i.selectNodeContents(s),l.addRange(i),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");u=!0}catch(d){n&&console.error("unable to copy using execCommand: ",d),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),u=!0}catch(d){n&&console.error("unable to copy using clipboardData: ",d),n&&console.error("falling back to prompt"),c=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"\u2318":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(c,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(i):l.removeAllRanges()),s&&document.body.removeChild(s),o()}return u}},2455:function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],r=0;r<e.rangeCount;r++)n.push(e.getRangeAt(r));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},2456:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="redo",a=[],c="f01e",o="M492 8h-10c-6.627 0-12 5.373-12 12v110.625C426.804 57.047 346.761 7.715 255.207 8.001 118.82 8.428 7.787 120.009 8 256.396 8.214 393.181 119.166 504 256 504c63.926 0 122.202-24.187 166.178-63.908 5.113-4.618 5.354-12.561.482-17.433l-7.069-7.069c-4.503-4.503-11.749-4.714-16.482-.454C361.218 449.238 311.065 470 256 470c-117.744 0-214-95.331-214-214 0-117.744 95.331-214 214-214 82.862 0 154.737 47.077 190.289 116H332c-6.627 0-12 5.373-12 12v10c0 6.627 5.373 12 12 12h160c6.627 0 12-5.373 12-12V20c0-6.627-5.373-12-12-12z";t.definition={prefix:"fal",iconName:r,icon:[512,512,a,c,o]},t.faRedo=t.definition,t.prefix="fal",t.iconName=r,t.width=512,t.height=512,t.ligatures=a,t.unicode=c,t.svgPathData=o},2457:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="copy",a=[],c="f0c5",o="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM352 32.491a15.88 15.88 0 0 1 7.431 4.195l51.882 51.883A15.885 15.885 0 0 1 415.508 96H352V32.491zM288 464c0 8.822-7.178 16-16 16H48c-8.822 0-16-7.178-16-16V144c0-8.822 7.178-16 16-16h80v240c0 26.51 21.49 48 48 48h112v48zm128-96c0 8.822-7.178 16-16 16H176c-8.822 0-16-7.178-16-16V48c0-8.822 7.178-16 16-16h144v72c0 13.2 10.8 24 24 24h72v240z";t.definition={prefix:"fal",iconName:r,icon:[448,512,a,c,o]},t.faCopy=t.definition,t.prefix="fal",t.iconName=r,t.width=448,t.height=512,t.ligatures=a,t.unicode=c,t.svgPathData=o},2579:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return se}));var r=n(15),a=n(5),c=n(0),o=n(251),i=n(1183),l=n(266),s=n(2281),u=n(2268),d=n(2451),f=n.n(d),b=n(1),j=n(9),h=n(4),v=n(16),O=n(77),p=n(46),x=n(528),m=n(171),g=n(8),C=n(1180),y=n(21),w=n(2),k=n(2274),R=n(2269),D=n(1188),S=n(2272);function E(e){return null!==e}var U=function(e){return{label:e.role,value:e.role,data:e}};function A(e){var t=e.roles,n=e.value,r=e.onChange,a=Object(b.useMemo)((function(){return t.map(U)}),[t]),o=Object(b.useMemo)((function(){return t.reduce((function(e,t){return Object(w.a)(Object(w.a)({},e),{},{[t.role]:t})}),{})}),[t]),i=(function(e){return e.every((function(e){return"string"===typeof e}))}(n)?n.map((function(e){return o[e]||null})).filter(E):n).map(U);return Object(c.jsx)(S.a,{placeholder:"Search roles...",fullWidth:!0,items:a,onChange:function(e){Array.isArray(e)&&r(e.map((function(e){return e.data})))},value:i})}function q(e){var t=e.user,n=e.onChange,r=e.roles,a=e.lockUsername,o=Object(b.useMemo)((function(){return r.filter((function(e){return e.is_default}))}),[r]);return Object(b.useEffect)((function(){0===t.roles.length&&o.length>0&&n(Object(w.a)(Object(w.a)({},t),{},{roles:o.map((function(e){return e.role}))}))}),[n,t,o]),Object(c.jsxs)(k.a,{spacing:24,variant:"column",alignItems:"stretch",children:[Object(c.jsx)(R.a,{text:"Name",children:Object(c.jsx)(D.a,{value:t.fullname,onChangeValue:function(e){return n(Object(w.a)(Object(w.a)({},t),{},{fullname:e}))},fullWidth:!0,placeholder:"Enter name...","data-qa":"edit-user-name",autoFocus:!0})}),Object(c.jsx)(R.a,{text:"Username",children:Object(c.jsx)(D.a,{value:t.username,onChangeValue:function(e){return n(Object(w.a)(Object(w.a)({},t),{},{username:e}))},fullWidth:!0,disabled:a,"data-qa":"edit-user-username",placeholder:"Enter username..."})}),Object(c.jsx)(R.a,{text:"Role",children:Object(c.jsx)(A,{roles:r,value:t.roles,onChange:function(e){return n(Object(w.a)(Object(w.a)({},t),{},{roles:e.map((function(e){return e.role}))}))}})})]})}var M=n(112),I=n.n(M),B=n(104),N=n(152),_=function(e){return I()(B.a,"invite?token=".concat(e.invite_code))};function T(e){var t=e.user;return t.invite_code?Object(c.jsx)(R.a,{text:"Copy this invitation token and share with the user","data-qa":"invite-token",children:Object(c.jsx)(N.a,{tooltipPlacement:"top",children:_(t)})}):null}var H=function(e){var t;switch(null===(t=e.response)||void 0===t?void 0:t.status){case 409:return"User with that username already exists"}return"Unknown error"};function F(e){var t=e.user,n=void 0===t?g.c:t,r=e.open,o=e.onChangeOpen,l=e.roles,s=e.regenerating,u=""===(null===n||void 0===n?void 0:n.username),d=u||s,f=Object(j.c)(),h=Object(j.d)((function(e){return e.users.newUser})),v=Object(j.d)((function(e){return e.users.error})),O=Object(b.useState)(n),x=Object(a.a)(O,2),m=x[0],w=x[1];Object(b.useEffect)((function(){!0===r&&w(n)}),[r,w,n]);var k=Object(b.useCallback)((function(){Object(g.sd)(m)&&f(p.j.request(m))}),[m,f]),R=Object(b.useCallback)((function(){f(p.b.request(m))}),[f,m]),D=Object(b.useCallback)((function(){f(p.a())}),[f]),S=Object(b.useCallback)((function(){D(),o(!1)}),[D,o]),E=d&&h?Object(c.jsx)(T,{user:h}):Object(c.jsx)(q,{lockUsername:!u,user:m,onChange:w,roles:l}),U=u?h?"User created!":"Create new user":s?h?"Invitation token regenerated!":"Regenerate invitation token":"Edit user",A=d?h?"Close":"Next":"Save",M=Object(C.b)(Object(c.jsx)(y.a,{minHeight:350,width:600,children:E}),{banner:v?{content:H(v),variant:"error"}:void 0,header:U,onAfterClose:S,footer:Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(i.a,{large:!0,ml:2,onClick:function(){if(d){if(!h)return void R()}else k();S()},variant:"primary",disabled:!Object(g.vd)(m),"aria-label":A,"data-qa":"user-modal-next",children:A}),(!d||!h)&&Object(c.jsx)(i.a,{large:!0,onClick:S,variant:"secondary","aria-label":"Cancel","data-qa":"user-modal-cancel",children:"Cancel"})]})}),I=Object(a.a)(M,2)[1];return Object(b.useEffect)((function(){I(r)}),[r,I]),null}var P=n(1184),V=n(980),z=n(65);function W(e){var t=e.onApply,n=e.onClose,r=e.offset,o=e.visible,l=e.availableRoles,s=e.selectedRoles,u=l.map((function(e){return e.role})),d=b.useState([]),f=Object(a.a)(d,2),j=f[0],h=f[1];b.useEffect((function(){h(s.map((function(e){return e.role})))}),[s]);var v=Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(y.d,{sx:{borderStyle:"solid",borderWidth:"1px 0 1px 0",borderColor:"#e8ebf4",flexGrow:1,height:"406px",overflow:"hidden"},children:Object(c.jsx)(y.a,{sx:{flexGrow:"1"},p:4,children:Object(c.jsx)(V.a,{p:4,name:"Roles",items:u,checkedItems:j,onChange:function(e){return h(e)}})})}),Object(c.jsxs)(y.d,{justifyContent:"flex-end",px:4,py:3,children:[Object(c.jsx)(i.a,{large:!0,onClick:n,variant:"secondary",children:"Cancel"}),Object(c.jsx)(i.a,{large:!0,ml:2,onClick:function(){var e=l.filter((function(e){return j.includes(e.role)}));t(e),n()},children:"Done"})]})]});return Object(c.jsx)(z.a,{popupWidth:"640px",content:v,hideCloseIcon:!0,title:Object(c.jsx)(P.a,{variant:"h2",children:"Filter by"}),offset:r,onClose:n,visible:o})}var L=n(2248);function G(e){var t=e.onClick,n=e.selectedRole,r=e.availableRoles,a=e.users,o=e.forwardedRef,i=b.useMemo((function(){return r.reduce((function(e,t){return Object(w.a)(Object(w.a)({},e),{},{[t.role]:a.filter((function(e){return e.roles.includes(t.role)})).length})}),{})}),[r,a]);return Object(c.jsxs)(y.a,{marginBottom:4,ref:o,children:[Object(c.jsx)(L.a,{active:"all"===n,label:"All",total:a.length,onChange:function(){return t()},mr:2,cannotBeCancelled:!0}),r.map((function(e){var r=e===n;return Object(c.jsx)(L.a,{active:r,onChange:function(){return t(r?void 0:e)},label:e.role,total:i[e.role],mr:2,cannotBeCancelled:!0},e.role)}))]})}var J=n(217),Q=n(2270),X=n(2278),K=n(979),Y=n(1187),Z=n(2457),$=n(118),ee=n(2456),te=n(58),ne=n(578),re=n(2454),ae=n.n(re),ce=n(11),oe=function(e,t){return{visibility:t?"visible":"hidden",[".table-row:hover &.".concat(e)]:{visibility:"visible"}}};function ie(e){var t=e.user,n=e.highlighted,r=e.onDelete,o=e.onEdit,s=e.onRegenerateInvite,u=Object(v.f)(ce.d.Users,ce.a.Create),d=Object(v.f)(ce.d.Users,ce.a.Delete),f=Object(v.f)(ce.d.Users,ce.a.Update),j=t.invite_expiry,h=j&&j<Date.now()/1e3,O=j&&j>Date.now()/1e3,p=Object(ne.b)("Delete",{placement:"top"}),x=Object(ne.b)("Regenerate invitation token",{placement:"top"}),m=Object(ne.b)("Edit",{placement:"top"}),g=function(e,t){var n=Object(b.useState)(!1),r=n[0],a=n[1],c=t&&t.successDuration;return Object(b.useEffect)((function(){if(r&&c){var e=setTimeout((function(){a(!1)}),c);return function(){clearTimeout(e)}}}),[r,c]),[r,function(){var t=ae()(e);a(t)}]}(_(t),{successDuration:1e4}),C=Object(a.a)(g,2),w=C[0],k=C[1],R=Object(ne.b)(w?"Invitation token copied!":"Copy invitation token",{placement:"top"}),D=Object(b.useCallback)((function(){return r([t])}),[r,t]),S=Object(b.useCallback)((function(){return s(t)}),[s,t]),E=Object(b.useCallback)((function(){return o(t)}),[o,t]);return Object(c.jsxs)(y.d,{flexDirection:"row-reverse",mr:-1,className:"user-row-actions",sx:oe("user-row-actions",n),children:[d&&Object(c.jsx)(i.a,{"data-qa":"delete-user",mr:1,variant:"icon",ref:p,onClick:D,children:Object(c.jsx)(l.a,{icon:te.faTrashAlt})}),u&&h&&Object(c.jsx)(i.a,{"data-qa":"regenerate-invitation-token",mr:1,variant:"icon",ref:x,onClick:S,children:Object(c.jsx)(l.a,{icon:ee.faRedo})}),t.invite_code&&O&&Object(c.jsx)(i.a,{variant:"icon",ref:R,onClick:k,children:Object(c.jsx)(l.a,{icon:Z.faCopy})}),f&&Object(c.jsx)(i.a,{"data-qa":"edit-user",mr:1,variant:"icon",ref:m,onClick:E,children:Object(c.jsx)(l.a,{icon:$.faEdit})})]})}function le(e){var t=e.onChangeSelected,n=e.onDelete,r=e.onEdit,o=e.onLoadMoreRows,i=e.onRegenerateInvite,l=e.selectedUsers,s=e.total,u=e.users,d=b.useState(void 0),f=Object(a.a)(d,2),j=f[0],v=f[1];return Object(c.jsxs)(X.a,{variant:"flattened",rows:u,onLoadMore:o,total:s,setHighlightedRow:v,highlight:j,children:[Object(c.jsx)(K.a,{width:"20%",title:"Name",children:function(e){var n=!!e.invite_expiry,r=l.includes(e);return Object(c.jsxs)(h.Flex,{alignItems:"center",children:[Object(c.jsx)(h.Box,{flex:"0 1 auto",mr:3,children:Object(c.jsx)("label",{children:Object(c.jsx)(Y.a,{checked:r,onChange:function(){return t(e,!r)}})})}),Object(c.jsx)(h.Box,{flex:"1",style:{overflow:"hidden",textOverflow:"ellipsis"},children:Object(c.jsx)(J.a,{variant:n?"faintBodySecondary":"bodySecondary","data-qa":"user-fullname",children:e.fullname||"-"})})]})}}),Object(c.jsx)(K.a,{width:"20%",title:"Username",children:function(e){var t=!!e.invite_expiry;return Object(c.jsx)(h.Box,{paddingTop:2,paddingBottom:2,"data-content":e.username,children:Object(c.jsx)(J.a,{variant:t?"faintBodySecondary":"bodySecondary",children:e.username})})}}),Object(c.jsx)(K.a,{width:"25%",title:"Roles",children:function(e){return Object(c.jsx)(h.Box,{paddingTop:2,paddingBottom:2,children:Object(c.jsx)(Q.a,{items:e.roles,limit:2})})}}),Object(c.jsx)(K.a,{width:"15%",dataQA:"user-table-column-invite",children:function(e){var t=e.invite_expiry;return t?Object(c.jsx)(h.Box,{py:2,textAlign:"right",children:t>Date.now()/1e3?Object(c.jsx)(J.a,{variant:"sidenote",children:"Waiting for user to register"}):Object(c.jsx)(J.a,{variant:"error",children:"Invitation token expired"})}):null}}),Object(c.jsx)(K.a,{width:"20%",sx:{pl:7},children:function(e,t){var a=t.highlighted;return Object(c.jsx)(ie,{user:e,highlighted:a,onDelete:n,onRegenerateInvite:i,onEdit:r})}})]})}function se(){var e=Object(v.k)(),t=Object(j.c)(),n=b.useCallback((function(e){return t(p.e.request(e))}),[t]);b.useEffect((function(){t(O.d.request({search:"",offset:0,limit:0}))}),[t]);var d=b.useCallback((function(e){return t(p.i(e))}),[t]),g=Object(j.d)((function(e){return e.users.users})),C=Object(j.d)((function(e){return e.users.searchQuery})),y=Object(j.d)((function(e){return Object.values(e.roles.roles)})),w=Object(v.n)(!1),k=Object(a.a)(w,2),R=k[0],D=k[1],S=b.useState([]),E=Object(a.a)(S,2),U=E[0],A=E[1],q=b.useState([]),M=Object(a.a)(q,2),I=M[0],B=M[1],N=b.useCallback((function(){return B([])}),[]);b.useEffect((function(){e("view:users:loaded")}),[e]),Object(v.a)((function(){return n({search:C,offset:0,limit:20})}),200,[n,C]);var _=b.useCallback((function(e){t(p.e.request({search:"",offset:Math.max(1,e-30),limit:30}))}),[t]),T=b.useCallback((function(e){return"Search ".concat(e," item").concat(1!==e?"s":"")}),[]),H=U.map((function(e){return e.role})),P=U.length>0?Object.values(g).filter((function(e){return f()(e.roles,H).length>0})):g,V=Number(Object.values(g).length),z=Number(P.length),L=b.useCallback((function(e){A(e||[]),N()}),[A,N]),J=Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(i.a,{variant:"headerIcon",onClick:D,active:R,children:Object(c.jsx)(l.a,{icon:o.faSlidersH})}),Object(c.jsx)(W,{onApply:L,onClose:D,visible:R,offset:[-4,-4],availableRoles:y,selectedRoles:U})]}),Q=b.useState(!1),X=Object(a.a)(Q,2),K=X[0],Y=X[1],Z=b.useState(void 0),$=Object(a.a)(Z,2),ee=$[0],te=$[1],ne=b.useState(!1),re=Object(a.a)(ne,2),ae=re[0],ce=re[1],oe=b.useCallback((function(e){t(p.c.request(e)),N()}),[t,N]),ie=b.useCallback((function(){t(p.a()),Y(!1),te(void 0),ce(!0)}),[Y,te,ce,t]),se=b.useCallback((function(e){Y(!1),te(e),ce(!0)}),[Y,te,ce]),ue=b.useCallback((function(e){Y(!0),te(e),ce(!0)}),[Y,te,ce]),de=Object(v.e)(),fe=Object(a.a)(de,2),be=fe[0],je=fe[1].height;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(F,{roles:y,open:ae,user:ee,regenerating:K,onChangeOpen:ce}),Object(c.jsx)(s.a,{title:"Users",rightContent:Object(c.jsx)(i.a,{variant:"primary","data-qa":"create-user",large:!0,mr:4,onClick:ie,children:"Create new user"}),children:Object(c.jsxs)(h.Box,{height:"calc(100% - ".concat(je,"px)"),children:[Object(c.jsx)(G,{onClick:function(e){return L(e?[e]:[])},selectedRole:0===U.length?"all":1===U.length?U[0]:"none",availableRoles:y,users:Object.values(g),forwardedRef:be}),Object(c.jsxs)(m.a,{children:[Object(c.jsx)(u.a,{buttons:[J],count:V,filterTablets:Object(c.jsx)(c.Fragment,{}),query:C,label:T,onChange:d,loading:!1}),!!I.length&&Object(c.jsx)(x.a,{label:"user selected",pluralLabel:"users selected",total:I.length,onClearSelection:N,children:Object(c.jsx)(i.a,{onClick:function(){return oe(I)},variant:"inverse",children:"Delete"})}),Object(c.jsx)(le,{users:Object.values(P),selectedUsers:I,total:z,onEdit:se,onDelete:oe,onLoadMoreRows:_,onChangeSelected:function(e,t){return t?function(e){return B([].concat(Object(r.a)(I),[e]))}(e):function(e){return B(I.filter((function(t){return t!==e})))}(e)},onRegenerateInvite:ue})]})]})})]})}}}]);